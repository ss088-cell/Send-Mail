<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h3>Upload Google Sheet</h3>
    <input type="file" id="fileInput" accept=".xlsx, .csv">
    <br><br>
    <button onclick="uploadFile()">Upload and Send</button>

    <script>
      function uploadFile() {
        var fileInput = document.getElementById("fileInput");
        var file = fileInput.files[0];

        var reader = new FileReader();
        reader.onload = function(e) {
          var fileContent = e.target.result;

          // Send the file content to Apps Script
          google.script.run
            .withSuccessHandler(function(response) {
              alert("File sent successfully to email!");
            })
            .sendFileToEmail(file.name, fileContent);
        };
        reader.readAsDataURL(file);
      }
    </script>
  </body>
</html>
