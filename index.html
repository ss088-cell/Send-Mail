<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script type="text/javascript">
      function showPicker() {
        // Load the picker API and show the picker
        google.script.run.withSuccessHandler(createPicker).loadPicker();
      }

      function createPicker(developerKey) {
        var picker = new google.picker.PickerBuilder()
          .addView(google.picker.ViewId.SPREADSHEETS)
          .setOAuthToken(google.script.run.getOAuthToken())
          .setDeveloperKey(developerKey)
          .setCallback(pickerCallback)
          .build();
        picker.setVisible(true);
      }

      function pickerCallback(data) {
        if (data.action == google.picker.Action.PICKED) {
          var fileId = data.docs[0].id;
          // Send the selected file ID to Apps Script
          google.script.run.sendSheetToEmail(fileId);
          alert("File has been sent!");
        }
      }
    </script>
  </head>
  <body>
    <h3>Select a Google Sheet from Drive</h3>
    <button onclick="showPicker()">Select Sheet</button>
  </body>
</html>
